%% Creation of BWabove and BWdown to mask path whenever other direction is selected.
%% Creation should be done according to your requirements in Image Segmentation

vidReader=vision.VideoFileReader('line.mp4','VideoOutputDataType','Double');
vidPlayer=vision.DeployableVideoPlayer
vidFrame1=step(vidReader);
I1=imresize(vidFrame1,[584,270]);
RGB=I1;
RGBmin = min(RGB(:));
RGBmax = max(RGB(:));
if isequal(RGBmax,RGBmin)
    RGB = 0*RGB;
else
    RGB = (RGB - RGBmin) ./ (RGBmax - RGBmin);
end

% Convert RGB image into L*a*b* color space.
X = rgb2lab(RGB);

% Create empty mask.
BWdown = false(size(X,1),size(X,2));

% Draw ROIs

xPos = [0.5000 270.5000 270.5000 0.5000];
yPos = [290.9118 287.7353 0.5000 1.8529];
m = size(BWdown, 1);
n = size(BWdown, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BWdown = BWdown | addedRegion;
RGB=I1;
RGBmin = min(RGB(:));
RGBmax = max(RGB(:));
if isequal(RGBmax,RGBmin)
    RGB = 0*RGB;
else
    RGB = (RGB - RGBmin) ./ (RGBmax - RGBmin);
end

% Convert RGB image into L*a*b* color space.
X = rgb2lab(RGB);

% Create empty mask.
BWabove = false(size(X,1),size(X,2));

% Draw ROIs

xPos = [1.6912 270.5000 270.5000 0.5000];
yPos = [295.6765 293.2941 583.9412 584.5000];
m = size(BWabove, 1);
n = size(BWabove, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BWabove = BWabove | addedRegion;

% Draw ROIs

xPos = [3.2794 3.2794 3.3227 3.5166 3.8363 4.0735 4.3107 4.6305 4.8676 5.1048 5.4246 5.6185 5.6618 5.6618 5.6618 5.6618 5.6618 5.6618 5.5752 5.1874 4.5479 4.1601 4.0735 4.0735 4.0735 4.0735 4.0735 3.9437 3.2970 2.0470 0.9856 0.5649 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5216 0.6619 1.0157 1.4323 1.6479 1.6912 1.6912 1.6912 1.7344 1.9284 2.2481 2.4420 2.4420 2.2048 1.6695 1.0589 0.6619 0.5216 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000];
yPos = [304.0568 307.2396 310.1605 312.5509 315.4220 318.9655 323.7591 330.4461 338.2391 346.5865 355.2786 364.1645 372.7227 379.6286 384.2939 388.1427 392.0804 395.1744 398.0616 403.0426 411.0439 420.8233 430.1756 437.5166 442.6051 445.8681 447.7801 448.9412 449.9725 451.0863 452.1176 453.1922 454.5865 456.3254 458.1901 459.7784 461.0469 462.2040 463.1920 464.0294 464.8235 465.6176 466.4118 467.2059 467.9567 468.5137 468.7076 468.3406 466.0993 459.8240 450.2450 440.9503 431.2935 421.0477 412.5720 406.9868 402.8351 397.9838 391.9154 385.4550 379.1886 373.5473 368.8651 364.7647 360.6643 355.9389 350.2334 344.4887 340.1735 337.5748 335.9393 334.3510 332.7235 331.4118 330.1000 328.4725 326.9275 325.5725 323.8977 321.6452 319.2668 317.3981 315.8491 314.1784 312.6767 311.6021 310.7214 309.6469 308.1452 306.5177 305.2924 304.4118 303.6609 303.1040];
m = size(BWabove, 1);
n = size(BWabove, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BWabove = BWabove | addedRegion;

xPos = [221.8348 222.8269 225.3351 229.4787 235.7307 243.9363 251.4841 256.3393 259.1359 261.3676 263.4263 264.9712 265.8519 266.3263 266.7325 267.1637 267.7639 268.5147 269.2223 269.3257 267.9930 265.2333 261.7699 257.3746 252.1580 246.6031 241.6918 238.2781 236.3229 235.2050 234.3676 233.5303 232.5422 231.4284 230.4403 229.6029 228.8088 228.0580 227.6309 228.1918 230.5100 235.0191 241.1044 246.7209 251.0505 255.0291 258.1687 260.5303 262.3950 263.6635 264.5441 265.3382 266.1324 266.9265 267.7639 268.7303 269.7039 270.2949 270.4784 270.5000 270.5000 270.5000];
yPos = [584.1081 584.3331 584.4696 584.5000 584.5000 584.5000 584.5000 584.5000 584.5000 584.5000 584.5000 584.5000 584.4696 584.2898 583.8709 583.3714 582.9531 582.5469 582.1590 581.7527 581.3649 580.9586 580.5708 580.2078 580.0139 580.0139 580.2078 580.5275 580.7214 580.8080 581.0452 581.5588 582.0725 582.3529 582.6334 583.1471 583.6912 584.0648 584.3331 584.4696 584.5000 584.5000 584.5000 584.5000 584.5000 584.5000 584.4696 584.2898 583.8709 583.3714 582.9531 582.5469 582.1157 581.5588 581.0019 580.5708 580.2511 580.2943 580.8080 581.6021 582.5469 583.4235];
m = size(BWabove, 1);
n = size(BWabove, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BWabove = BWabove | addedRegion;

% Draw ROIs

xPos = [3.3227 3.6031 4.3973 5.6185 6.7323 7.4439 8.0441 8.5578 8.7950 8.8382 8.8815 9.0754 9.3952 9.6324 9.8695 10.1893 10.3832 10.4265 10.4265 10.4265 10.4265 10.3832 10.1460 9.5025 8.3638 6.8870 5.4678 4.1168 3.0030 2.2914 1.6695 1.0589 0.6619];
yPos = [389.4128 398.9117 406.7817 411.8116 415.9080 419.6229 422.8178 425.5488 428.2941 430.8664 432.7351 434.1334 435.7216 437.6296 439.7355 442.3118 445.2470 447.7801 449.6488 451.0863 452.3116 453.5120 454.7805 456.3687 458.1901 459.7351 460.8097 461.6471 462.4412 463.1920 463.7489 463.9861 464.0294];
m = size(BWabove, 1);
n = size(BWabove, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BWabove = BWabove | addedRegion;

xPos = [221.2904 222.7404 225.3310 228.4458 231.7481 234.7948 237.1771 238.8086 239.9265 241.0876 242.8698 245.2481 247.5872 249.6498 251.5578 253.1152 254.0676 255.0953 256.2218 257.2298 258.0545 258.7931 259.2973 259.5177 259.6910 260.0863 260.4783 260.7397 260.9436 261.1463 261.3215 261.3819 261.3524 261.4094 261.4592 261.4103 261.3676];
yPos = [583.1444 583.1038 582.9099 582.5469 582.1157 581.5156 580.8080 580.2511 580.0139 579.9706 580.0139 580.2078 580.5708 580.9586 581.3216 581.5129 581.5249 581.4930 581.5037 581.6640 581.9489 582.1064 582.1547 582.3080 582.5847 582.7330 582.7282 582.6781 582.6268 582.5754 582.5686 582.7156 582.9934 583.1523 583.1691 583.1526 583.1471];
m = size(BWabove, 1);
n = size(BWabove, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BWabove = BWabove | addedRegion;

% Fill holes
BWabove = imfill(BWabove, 'holes');
